* Prima versione
#+begin_src fortran
SUBROUTINE lanczos_naive(dim, D, U) !dimension, diagonal and upper diagonal of resulting symmetric tridiagonal matrix
  INTEGER :: i, dim
  INTEGER, PARAMETER :: dp=KIND(0.d0)
  REAL(dp), DIMENSION(dim,dim) :: Q
  REAL(dp), DIMENSION(dim) :: rnd, tmp, D, r, dtmp
  real(dp), dimension(dim-1) :: U, utmp
  open(unit=4, file="eigv.txt")

  call random_seed
  call random_number(rnd)
  Q(:,1) = rnd/NORM2(rnd)
  
  call prodotto(Q(:,1), dim, tmp)
  D(1) = dot_product(Q(:,1), tmp)
  write(4,*), 0, abs(correctegv(dim) - d(1)), abs(correctegv(dim-1) - d(1)),&
       abs(correctegv(2) - d(1)), abs(correctegv(1) - d(1))
  
  r = tmp - D(1)*Q(:,1)
  U(1) = norm2(r)
  Q(:,2) = r/U(1)
  do i=2, dim
     call prodotto(Q(:,i), dim, tmp)
     D(i) = dot_product(Q(:,i), tmp)
     r = tmp - D(i)*Q(:,i) - U(i-1)*Q(:,i-1)
     if (i < dim) then
        U(i) = norm2(r)
        Q(:,i+1) = r/U(i)
     end if
     write(*,*), d
     dtmp = d
     utmp = u
     call eigenvalues(dtmp(1:i), utmp(1:i), eig, i)
     !write(4,*), i-1, abs(correctegv(dim) - eig(i)), abs(correctegv(dim-1) - eig(i-1)),&
     !     abs(correctegv(2) - eig(2)), abs(correctegv(1) - eig(1))
  end do
END SUBROUTINE lanczos_naive
#+end_src 
* Autovalori della tridiagonale

[[http://www.netlib.org/lapack/explore-html/d9/d45/dstevr_8f.html#][DSTEVR]]
